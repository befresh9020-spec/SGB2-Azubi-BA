<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2a0f17">
    <title>SGB2 lernen</title>
    <link rel="stylesheet" href="styles-main.css">
		<script src="gate.js" defer></script>
</head>
	
<body>
    <div id="gate-screen">
    <div class="lock-card">
        <div class="logo"></div> 
        <h2>Lernportal SGB II</h2>
        <p>Zugang nur fÃ¼r BA-Auszubildende.</p>
        
        <div class="input-group">
            <input type="password" id="pw-field" placeholder="Passwort eingeben...">
            
            <button class="login-btn" onclick="unlockApp()">Einloggen</button>
            
            <a href="mailto:sgb2-lernen-pw@gmx.net?subject=Passwortanfrage%20Lernportal&body=Hallo%20BjÃ¸rn%2C%20ich%20bitte%20um%20das%20Passwort%20f%C3%BCr%20das%20Lernportal.%20Dienststelle%3A%20..." 
               class="request-btn">
               Passwort anfragen (per Mail)
            </a>
        </div>
    </div>
</div>

    <div id="main-app" style="display: none;">
					
					<header class="header">
    <h1>SGB II - BÃ¼rgergeld</h1>
    <p>Lernplattform fÃ¼r Azubis der BA</p>
	
	<button id="themeToggle" class="theme-switch" aria-pressed="false" type="button">
  <span class="switch-track" aria-hidden="true">
    <span class="switch-thumb"></span>
  </span>

  <!-- optionaler Text (wird auf Mobile ausgeblendet) -->
  <span class="switch-text" aria-hidden="true">Design</span>

  <!-- nur fÃ¼r Screenreader -->
  <span class="sr-only">Modus umschalten</span>
</button>

</header>

<!-- ğŸ”” Update-Slider -->
<section class="update-banner" aria-label="Aktuelle Updates">

  <div class="update-slider" id="updateSlider">

    <!-- Slide 1 -->
    <div class="update-slide is-active">
      <div class="update-meta">
        <span class="update-tag">Neu</span>
        <span class="update-date">19.01.2026</span>
      </div>

      <a href="Audio.html" class="update-title">
        ğŸ§ Neue Podcast-Folge - vom 15.01.2026
      </a>
			
			<div class="update-sub">
			Grundsicherung: Nahles Ã¤uÃŸert Zweifel
      </div>
			
    </div>

    <!-- Slide 2 -->
    <div class="update-slide">
      <div class="update-meta">
        <span class="update-tag">Quiz</span>
        <span class="update-date">16.01.2026</span>
      </div>

   <a href="Quiz.html" class="update-title">
       ğŸ§© Neue Quiz-Fragen hinzugefÃ¼gt
      </a>
</div>

    </div>
	</div>

  <div class="update-dots" role="tablist" aria-label="Updates auswÃ¤hlen">
    <button class="dot is-active" aria-label="Update 1"></button>
    <button class="dot" aria-label="Update 2"></button>
  </div>

</section>

<!-- ğŸ” Dezente Paragraphen-Suche -->

<button id="toggleSearch" class="search-toggle" type="button" aria-expanded="false">
  <span class="icon">ğŸ”</span>
  <span class="label">Â§-Suche</span>
  <span class="chevron" aria-hidden="true">â–¾</span>
</button>

	<section class="search-bar" id="searchContainer" hidden>
  <form id="paragraphSearchForm" class="search-form">
    <label for="paragraphInput">Paragraph im SGB II suchen</label>

    <div class="search-row">
      <input
        id="paragraphInput"
        type="text"
        autocomplete="off"
        placeholder="Â§Â§-Sucheâ€¦"
      >
      <button type="submit">ğŸ”</button>
    </div>

    <p id="searchError" class="search-error" aria-live="polite"></p>
  </form>
</section>

<!-- Drop-Down-MenÃ¼/Filter -->

<div class="controls controls-container">
  <label for="topicFilter">Thema auswÃ¤hlen</label>
  <div class="select-wrap">
    <select id="topicFilter" class="input-like">
      <option value="all">Alle Themen</option>
      <option value="Berechtigte">Berechtigte</option>
      <option value="Bedarfe">Bedarfe</option>
      <option value="VermÃ¶gen">VermÃ¶gen</option>
      <option value="Einkommen">Einkommen</option>
      <option value="Leistungsminderungen">Leistungsminderungen</option>
      <option value="AGP">AGP</option>
      <option value="Quiz">Quiz</option>
      <option value="News">News</option>
    </select>
  </div>
</div>
					
<main class="container">

    <!-- Karte 1 -->
    <article class="flip-card" 
        data-topic="Berechtigte"
        tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                <h3>Leistungsberechtigte & Bedarfsgemeinschaft</h3>
                <p class="card-front-text">Wer ist eigentlich leistungsberechtigt? Wie wird eine Bedarfsgemeinschaft gebildet? Wie funktioniert die Antragstellung?</p>
                <p class="card-front-paragraphs">Â§ 7, Â§ 7a, Â§ 37, Â§ 38</p>
            </div>
            <div class="flip-card-back" aria-hidden="true">
                <h3>Ãœberblick</h3>
                <p>Hier findest du den relevanten Gesetzestext mit Vertiefungsgrad und Sachverhalte zum Ãœben.</p>
                <div class="card-links">
                    <a href="Berechtigte.html" class="card-link">ğŸ“– Gesetz</a>
                    <a href="Berechtigte_SV.html" class="card-link">ğŸ“„ Sachverhalte</a>
                </div>
            </div>
        </div>
    </article>


        <!-- Karte 2 -->
       <article class="flip-card" 
        data-topic="Bedarfe"
        tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>Bedarfe</h3>
				    <p class="card-front-text">Was versteht man unter Regelbedarf, Mehrbedarf und Bedarf fÃ¼r Unterkunft?</p>
                    <p class="card-front-paragraphs">Â§ 19, Â§ 20, Â§ 21, Â§ 22, Â§ 23, Â§ 72</p>
                </div>
                <div class="flip-card-back">
                    <h3>Ãœbersicht</h3>
                    <p>Hier findest du den relevanten Gesetzestext mit Vertiefungsgrad und Sachverhalte zum Ãœben.</p>
                    <div class="card-links">
                        <a href="Bedarfe.html" class="card-link">ğŸ“– Gesetz</a>
                        <a href="Bedarfe_SV.html" class="card-link">ğŸ“„ Sachverhalte</a>
                    </div>
                </div>
            </div>
        </article>

        <!-- Karte 3 -->
       <article class="flip-card" 
        data-topic="VermÃ¶gen"
        tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>Anrechnung VermÃ¶gen</h3>
				    <p class="card-front-text">Was ist VermÃ¶gen und wie wird es berÃ¼cksichtigt?</p>
                    <p class="card-front-paragraphs">Â§ 12, Â§ 7 BÃ¼rgergeld-V, Fachliche Weisungen zu Â§ 12</p>
                </div>
                <div class="flip-card-back">
                    <h3>Ãœbersicht</h3>
                    <p>Hier findest du den relevanten Gesetzestext mit Vertiefungsgrad und Sachverhalte zum Ãœben.</p>
                    <div class="card-links">
                        <a href="VM.html" class="card-link">ğŸ“– Gesetz</a>
                        <a href="VM_SV.html" class="card-link">ğŸ“„ Sachverhalte</a>
                    </div>
                </div>
            </div>
        </article>

        <!-- Karte 4 -->
         <article class="flip-card" 
            data-topic="Einkommen"
            tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>Anrechnung Einkommen</h3>
				    <p class="card-front-text">Was ist Einkommen und wie wird es berÃ¼cksichtigt?</p>
                    <p class="card-front-paragraphs">Â§ 11, Â§ 11a, Â§ 11b, Â§Â§ 1, 2, 6 BÃ¼rgergeld-V, Fachliche Weisungen zu Â§ 11b</p>
                </div>
                <div class="flip-card-back">
                    <h3>Ãœbersicht</h3>
                    <p>Hier findest du den relevanten Gesetzestext mit Vertiefungsgrad und Sachverhalte zum Ãœben.</p>
                    <div class="card-links">
                        <a href="EK.html" class="card-link">ğŸ“– Gesetz</a>
                        <a href="EK_SV.html" class="card-link">ğŸ“„ Sachverhalte</a>
                    </div>
                </div>
            </div>
         </article>

        <!-- Karte 5 -->
         <article class="flip-card flip-card--compact" 
            data-topic="HilfebedÃ¼rftigkeit"
            tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>HilfebedÃ¼rftigkeit</h3>
                    <p class="card-front-paragraphs">Â§ 9</p>
                </div>
                <div class="flip-card-back flip-card-back--compact" aria-hidden="true">
                    <h3>Ãœbersicht</h3>
                    <p>Hier findest du den relevanten Gesetzestext mit Vertiefungsgrad und Sachverhalte zum Ãœben.</p>
                    <div class="card-links">
                        <a href="Hilfebeduerftigkeit.html" class="card-link">ğŸ“– Gesetz</a>
						<a href="https://learningapps.org/watch?v=pi89pszy525" class="card-link">ğŸ“– Bedarfsanteilsmethode (LearningApps)</a>
                        <a href="9_SV.html" class="card-link">ğŸ“„ Sachverhalte</a>
                    </div>
                </div>
            </div>
        </article>

        <!-- Karte 6 -->
       <article class="flip-card" 
        data-topic="Leistungsminderungen"
        tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>Leistungsminderungen</h3>
				    <p class="card-front-text">Wann liegt eine Pflichtverletzung vor? Welche Auswirkungen hat eine Leistungsminderung?</p>
                    <p class="card-front-paragraphs">Â§ 31, Â§ 31a, Â§ 31b, Â§ 32</p>
                </div>
                <div class="flip-card-back">
                    <h3>Ãœbersicht</h3>
                    <p>Hier findest du den relevanten Gesetzestext mit Vertiefungsgrad und Sachverhalte zum Ãœben.</p>
                    <div class="card-links">
                        <a href="Minderung.html" class="card-link">ğŸ“– Gesetz</a>
                        <a href="Minderung_SV.html" class="card-link">ğŸ“„ Sachverhalte</a>
                    </div>
                </div>
            </div>
         </article>

	<!-- Karte 7 -->
         <article class="flip-card" 
            data-topic="BuT"
            tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>Bildung und Teilhabe</h3>
				    <p class="card-front-text">Das Bildungs- und Teilhabepaket (BuT) wurde 2011 eingefÃ¼hrt und hilft einkommensschwachen Familien. BuT wird fÃ¼r Kinder
					und Jugendliche erbracht.</p>
                    <p class="card-front-paragraphs">Â§ 28</p>
                </div>
                <div class="flip-card-back">
                    <h3>Ãœbersicht</h3>
                    <p>Hier findest du den relevanten Gesetzestext mit Vertiefungsgrad.</p>
                    <div class="card-links">
                        <a href="BuT.html" class="card-link">ğŸ“– Gesetz</a>
                    </div>
                </div>
            </div>
         </article>
        
        	<!-- Karte 8 -->
      <article class="flip-card flip-card--compact" 
        data-topic="AGP"
        tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>AGP</h3>
				    <p class="card-front-text">Rechtliche Grundlagen des SGB II, Mitteilungs- & Mitwirkungspflichten und Eingliederungsleistungen</p>
                </div>
                <div class="flip-card-back flip-card-back--compact" aria-hidden="true">
                    <h3>Ãœbersicht</h3>
                    <p>Hier findest du die Rechtsgrundlagen mit Vertiefungsgrad und SVs zum Ãœben.</p>
                    <div class="card-links">
                        <a href="AGP1.html" class="card-link">ğŸ“– Gesetz (rechtl. Grundlagen)</a>
						<a href="AGP2.html" class="card-link">ğŸ“– Gesetz (Eingliederungsleistungen)</a>
                        <a href="AGP_SV.html" class="card-link">ğŸ“„ Sachverhalte</a>
                    </div>
                </div>
            </div>
        </article>
        
        <!-- Karte 9 -->
       <article class="flip-card" 
        data-topic="Quiz"
        tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>Quiz</h3>
		    <p class="card-front-text">Keine Lust auf Sachverhalte? Dann lass uns eine Runde quizzen!</p>
                </div>
                <div class="flip-card-back">
                    <h3>Ãœbersicht</h3>
                    <div class="card-links">
                        <a href="Quiz.html" class="card-link">ğŸ“– Quiz</a>
                    </div>
                </div>
            </div>
        </article>

	<!-- Karte 10 -->
      <article class="flip-card" 
        data-topic="Audio"
        tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                    <h3>Audio & Video</h3>
                <p class="card-front-text">Podcast-Folgen zum SGB II und Videos der BA zum BÃ¼rgergeld</p>
                <p class="card-front-paragraphs">Audio-Lerninhalte in Planung</p>
                </div>
                <div class="flip-card-back">
                    <h3>Ãœbersicht</h3>
                    <p>Mit einem Klick auf Audio kannst du dir die Themen zum SGB II anhÃ¶ren.</p>
                    <div class="card-links">
                        <a href="Audio.html" class="card-link">ğŸ§ Audio & Video ğŸ¬</a>
                    </div>
                </div>
            </div>
         </article>
	
<!-- Beispiel News-Karte (mit externen Link-Verbesserungen) -->
    <article class="flip-card flip-card--compact" 
        data-topic="News"
        tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
                <h3>News zum SGB II</h3>
				<p class="card-front-text">Nachrichten aus Politik, zu geplanten Reformen und Studien zum BÃ¼rgergeld</p>
            </div>
            <div class="flip-card-back flip-card-back--compact" aria-hidden="true">
                <h3>Aktuelle Meldungen</h3>
                <p>Ãœber das SGB II wird regelmÃ¤ÃŸig in den Medien berichtet.</p>
                <div class="card-links">
				<a href="https://www.tagesschau.de/inland/innenpolitik/buergergeld-reform-104.html"
                   class="card-link"
                   target="_blank"
                   rel="noopener noreferrer">ğŸ“° Tagesschau: Kabinett beschlieÃŸt neue Grundsicherung</a>
                <a href="https://www.bmas.de/DE/Service/Presse/Pressemitteilungen/2025/gesetzentwurf-umgestaltung-grundsicherung-arbeitsuchende.html"
                   class="card-link"
                   target="_blank"
                   rel="noopener noreferrer">ğŸ“°Pressemitteilung BMAS vom 17.12.2025</a>
                   <a href="https://www.tagesschau.de/inland/innenpolitik/buergergeldreform-kritik-100.html"
                   class="card-link"
                   target="_blank"
                   rel="noopener noreferrer">ğŸ“°Tagesschau: â€Studie: BÃ¼rgergeld und Stellensucheâ€œ</a>
				</div>
				</div>
        </div>
    </article>

	<!-- Karte 12 -->
 <article class="flip-card flip-card--compact" 
    data-topic="Unterlagen"
    tabindex="0" role="button" aria-expanded="false">
        <div class="flip-card-inner">
            <div class="flip-card-front" aria-hidden="false">
                <div class="logo" aria-hidden="true"></div>
            <h3>Bundesagentur fÃ¼r Arbeit / BMAS</h3>
            <p>Merkblatt SGB II & Co.</p>
        </div>
        <div class="flip-card-back flip-card-back--compact" aria-hidden="true">
            <h3>Ãœberblick</h3>
            <p>Hier findest du Informationen, die du zur Vorbereitung auf die praktische AbschlussprÃ¼fung nutzen kannst.</p>
            <div class="card-links">
             <a href="https://www.arbeitsagentur.de/datei/merkblatt-buergergeld_ba043375.pdf" class="card-link">Merkblatt SGB II</a>
			 <a href="https://www.arbeitsagentur.de/datei/grundsicherung-einfach-erklaer_ba032300.pdf" class="card-link">Einfach erklÃ¤rt</a>
            <a href="https://www.bmas.de/DE/Arbeit/Grundsicherung-Buergergeld/grundsicherung-buergergeld.html" class="card-link">BMAS zum BÃ¼rgergeld</a>
             </div>
            </div>
        </div>
      </article>

</main>
					
				<footer class="page-footer">
  <div class="footer-pill tip">
    ğŸ’¡ Klicken oder Enter, um eine Karte zu drehen
  </div>

  <div class="footer-info">
    <span class="author">ğŸ¤µğŸ»â€â™‚ï¸ B. Frischer</span>
    <span class="version-tag">Version 2.0 â€¢ Stand Jan. 2026</span>
  </div>

  <div class="branding-text">
    FÃ¼r Auszubildende der BA Â· <strong>Deine Lernreise</strong>
  </div>

  <div class="train-container">
    <svg class="train" width="120" height="40" viewBox="0 0 120 40" aria-hidden="true">
			<!-- Gleise -->
    <rect x="0" y="32" width="120" height="2" fill="#666"/>
    <rect x="0" y="34" width="120" height="1" fill="#444"/>
            <!-- Schatten unter Gleis -->
    <rect x="0" y="35" width="120" height="1" fill="rgba(0,0,0,0.4)"/>

    <!-- Rauch -->
    <circle class="smoke" cx="15" cy="10" r="3" fill="rgba(255,255,255,0.8)">
      <animate attributeName="cy" values="10;4;10" dur="2.5s" repeatCount="indefinite"/>
      <animate attributeName="r"  values="2.5;3.5;2.5" dur="2.5s" repeatCount="indefinite"/>
      <animate attributeName="opacity" values="0.8;0.2;0.8" dur="2.5s" repeatCount="indefinite"/>
    </circle>
    <circle class="smoke" cx="19" cy="9" r="2.5" fill="rgba(255,255,255,0.7)">
      <animate attributeName="cy" values="9;3;9" dur="3s" begin="0.6s" repeatCount="indefinite"/>
      <animate attributeName="r"  values="2;3;2" dur="3s" begin="0.6s" repeatCount="indefinite"/>
      <animate attributeName="opacity" values="0.7;0.1;0.7" dur="3s" begin="0.6s" repeatCount="indefinite"/>
    </circle>
    <circle class="smoke" cx="23" cy="8" r="2" fill="rgba(255,255,255,0.6)">
      <animate attributeName="cy" values="8;2;8" dur="2.2s" begin="1.2s" repeatCount="indefinite"/>
      <animate attributeName="r"  values="1.5;3;1.5" dur="2.2s" begin="1.2s" repeatCount="indefinite"/>
      <animate attributeName="opacity" values="0.6;0;0.6" dur="2.2s" begin="1.2s" repeatCount="indefinite"/>
    </circle>

    <!-- Lok -->
    <!-- Schornstein -->
    <rect x="13" y="14" width="4" height="6"
      fill="#111"
      stroke="rgba(255,255,255,0.35)"
      stroke-width="0.4"/>

    <!-- Kessel -->
    <rect x="10" y="20" width="18" height="10"
      fill="#111"
      stroke="rgba(255,255,255,0.35)"
      stroke-width="0.6"/>
    
    <!-- Lichtkante Kessel -->
    <rect x="10" y="20" width="18" height="1" fill="rgba(255,255,255,0.12)"/>

    <!-- Fenster -->
    <rect class="window" x="18.5" y="15" width="3" height="3" fill="#d0d0d0" rx="0.5"/>

    <!-- Fahrwerk -->
    <rect x="9" y="30" width="20" height="2" fill="#333"/>
    <circle cx="13" cy="32" r="2" fill="#000"/>
    <circle cx="18" cy="32" r="2" fill="#222"/>
    <circle cx="23" cy="32" r="2" fill="#000"/>
    
    <!-- Kupplung -->
    <rect x="28" y="27" width="3" height="1" fill="#555"/>

    <!-- Waggon 1 -->
    <rect x="32" y="22" width="20" height="8" fill="#004A9F" stroke="#002A5F" stroke-width="0.8"/>
    <rect class="window" x="37" y="23.5" width="3" height="3" fill="#d0d0d0" rx="0.5"/>
    <circle cx="36" cy="32" r="2" fill="#000"/>
    <circle cx="46" cy="32" r="2" fill="#000"/>

    <!-- Waggon 2 -->
    <rect x="56" y="22" width="20" height="8" fill="#E2001A" stroke="#A00012" stroke-width="0.8"/>
    <rect class="window" x="61" y="23.5" width="3" height="3" fill="#d0d0d0" rx="0.5"/>
    <circle cx="60" cy="32" r="2" fill="#000"/>
    <circle cx="70" cy="32" r="2" fill="#000"/>
    
    <!-- Waggon 3 -->
    <rect x="80" y="22" width="20" height="8"
      fill="#FFB300"
      stroke="#9A9A94"
      stroke-width="0.8"/>
    <rect class="window" x="85" y="23.5" width="3" height="3"
      fill="#f2f2f2" rx="0.5"/>
    <circle cx="84" cy="32" r="2" fill="#000"/>
    <circle cx="94" cy="32" r="2" fill="#000"/>

    </svg>
  </div>

  <nav class="footer-links">
   <a href="mailto:ba-azubicontent@posteo.de?subject=Feedback%20zur%20Lernreise%20SGB%20II">Feedback senden</a>
   <a href="impressum.html">Impressum</a>
   <a href="disclaimer.html">Disclaimer</a>
  </nav>
</footer>	
    </div>

</body>

<script>
(() => {
  'use strict';

  // ---------- Helpers ----------
  const qs  = (sel, root = document) => root.querySelector(sel);
  const qsa = (sel, root = document) => Array.from(root.querySelectorAll(sel));
  const norm = (s) => (s ?? '').toString().trim().toLowerCase();

  // ---------- Flip Cards (ARIA + Interaction) ----------
  function updateAriaState(card, expanded) {
    const front = qs('.flip-card-front', card);
    const back  = qs('.flip-card-back', card);

    if (!front || !back) return;

    const expandedStr = expanded ? 'true' : 'false';
    front.setAttribute('aria-hidden', expanded ? 'true' : 'false');
    back.setAttribute('aria-hidden', expanded ? 'false' : 'true');
    card.setAttribute('aria-expanded', expandedStr);
  }

  function flipCard(card) {
    const expanded = card.classList.toggle('flipped');
    updateAriaState(card, expanded);

    if (navigator.vibrate) navigator.vibrate(50);

    // Klick-/Tap-Feedback ohne harte Transform-Ãœberschreibung
    card.classList.add('is-pressing');
    window.setTimeout(() => card.classList.remove('is-pressing'), 150);
  }

  function initFlipCards() {
    const cards = qsa('.flip-card');

    cards.forEach(card => {
      card.setAttribute('role', 'button');
      card.setAttribute('tabindex', '0');
      card.setAttribute('aria-expanded', 'false');

      // Initiale ARIA-Sichtbarkeit
      updateAriaState(card, false);

      // Click / Tap
      card.addEventListener('click', () => flipCard(card));

      // Keyboard
      card.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ' || e.key === 'Spacebar') {
          e.preventDefault();
          flipCard(card);
        }
      });

      // Touch feedback (optional zusÃ¤tzlich)
      card.addEventListener('touchstart', () => card.classList.add('is-pressing'), { passive: true });
      card.addEventListener('touchend', () => {
        window.setTimeout(() => card.classList.remove('is-pressing'), 150);
      }, { passive: true });
    });
  }

  // ---------- Theme Switch ----------
  function initThemeSwitch() {
    const themeButton = document.getElementById('themeToggle');
    if (!themeButton) return;

    const saved = localStorage.getItem('theme');
    if (saved === 'dark' || saved === 'light') {
      document.documentElement.setAttribute('data-theme', saved);
      themeButton.setAttribute('aria-pressed', saved === 'dark' ? 'true' : 'false');
    } else {
      // Optional: initialer aria-pressed Status passend zum effektiven Theme
      const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const current = document.documentElement.getAttribute('data-theme');
      const effective = current ?? (systemDark ? 'dark' : 'light');
      themeButton.setAttribute('aria-pressed', effective === 'dark' ? 'true' : 'false');
    }

    themeButton.addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme');
      const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const effective = current ?? (systemDark ? 'dark' : 'light');
      const next = (effective === 'dark') ? 'light' : 'dark';

      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      themeButton.setAttribute('aria-pressed', next === 'dark' ? 'true' : 'false');
    });
  }

  // ---------- Paragraph Search ----------
  const paragraphIndex = {
    "7":  "Berechtigte.html#Â§7",
    "7a": "Berechtigte.html#Â§7a",
    "37": "Berechtigte.html#Â§37",
    "38": "Berechtigte.html#Â§38",
    "19": "Bedarfe.html#Â§19",
    "20": "Bedarfe.html#Â§20",
    "21": "Bedarfe.html#Â§21",
    "22": "Bedarfe.html#Â§22",
    "23": "Bedarfe.html#Â§23",
    "72": "Bedarfe.html#Â§72",
    "12": "VM.html#Â§12",
    "11":  "EK.html#Â§11",
    "11a": "EK.html#Â§11a",
    "11b": "EK.html#Â§11b",
    "9": "Hilfebeduerftigkeit.html#Â§9",
    "31":  "Minderung.html#Â§31",
    "31a": "Minderung.html#Â§31a",
    "31b": "Minderung.html#Â§31b",
    "32":  "Minderung.html#Â§32",
    "28": "BuT.html#Â§28",
    "1": "AGP1.html#Â§1",
    "2": "AGP1.html#Â§2",
    "6": "AGP1.html#Â§6",
    "44b": "AGP1.html#Â§44b",
    "6d": "AGP1.html#Â§6d",
    "6a": "AGP1.html#Â§6a",
    "18a": "AGP1.html#Â§18a",
    "7b": "AGP1.html#Â§7b",
    "13": "AGP1.html#Â§13",
    "56": "AGP1.html#Â§56",
    "59": "AGP1.html#Â§59",
    "3": "AGP2.html#Â§3",
    "4": "AGP2.html#Â§4",
    "36": "AGP2.html#Â§36",
    "5": "AGP2.html#Â§5",
    "12a": "AGP2.html#Â§12a",
    "14": "AGP2.html#Â§14",
    "15": "AGP2.html#Â§15",
    "15a": "AGP2.html#Â§15a",
    "16": "AGP2.html#Â§16"
  };

  function normalizeParagraphInput(raw) {
    return (raw ?? '')
      .toLowerCase()
      .replace(/Â§/g, '')
      .replace(/\s+/g, '')
      .replace(/abs\..*/g, '');
  }

  function initParagraphSearch() {
    const searchForm  = document.getElementById('paragraphSearchForm');
    const searchInput = document.getElementById('paragraphInput');
    const searchError = document.getElementById('searchError');

    if (!searchForm || !searchInput || !searchError) return;

    searchForm.addEventListener('submit', (e) => {
      e.preventDefault();
      searchError.textContent = '';

      const key = normalizeParagraphInput(searchInput.value);

      if (!key) {
        searchError.textContent = 'Bitte einen Paragraphen eingeben, z.B. 7 oder 31b.';
        return;
      }

      const target = paragraphIndex[key];
      if (!target) {
        searchError.textContent = 'Diesen Paragraphen habe ich hier (noch) nicht hinterlegt.';
        return;
      }

      window.location.href = target;
    });
  }
	
	  // ---------- Searchbar Toggle ----------
  function initSearchToggle() {
    const toggleButton   = document.getElementById('toggleSearch');
    const searchContainer = document.getElementById('searchContainer');
    const searchInput     = document.getElementById('paragraphInput');

    if (!toggleButton || !searchContainer) return;

    toggleButton.addEventListener('click', () => {
      const isOpen = !searchContainer.hasAttribute('hidden');

      if (isOpen) {
        searchContainer.setAttribute('hidden', '');
        toggleButton.setAttribute('aria-expanded', 'false');
      } else {
        searchContainer.removeAttribute('hidden');
        toggleButton.setAttribute('aria-expanded', 'true');

        // Fokus ins Suchfeld (optional, aber UX-freundlich)
        if (searchInput) searchInput.focus();
      }
    });
  }

  // ---------- Service Worker ----------
  function initServiceWorker() {
    if (!('serviceWorker' in navigator)) return;

    navigator.serviceWorker.register('service-worker.js')
      .then(reg => console.log('Service Worker registriert:', reg.scope))
      .catch(err => console.error('Service Worker Registrierung fehlgeschlagen:', err));
  }

  // ---------- Drop-Down Filter + Stagger Animation ----------
  function initTopicFilter() {
    const select = document.getElementById('topicFilter');
    const cards  = qsa('article.flip-card[data-topic]');

    if (!select || cards.length === 0) return;

    function applyFilter() {
      const value = norm(select.value);
      let visibleCount = 0;

      cards.forEach((card) => {
        const topic = norm(card.dataset.topic);
        const match = (value === 'all') || (topic === value);

        if (match) {
          card.classList.remove('is-hidden');

          // Animation reset
          card.style.animation = 'none';
          // Reflow trigger
          void card.offsetHeight;

          const delay = visibleCount * 0.1;
          card.style.animation = `fadeInUp 1s ${delay}s cubic-bezier(0.22, 1, 0.36, 1) forwards`;

          visibleCount++;
        } else {
          card.classList.add('is-hidden');
          card.style.animation = 'none';
          card.style.opacity = '0';
        }
      });
    }

    select.addEventListener('change', applyFilter);
    applyFilter();
  }

  // ---------- iOS Double-tap zoom prevention (eingeschrÃ¤nkt) ----------
  function initDoubleTapPrevention() {
    let lastTouchEnd = 0;

    document.addEventListener('touchend', (event) => {
      // nur fÃ¼r interaktive Bereiche (Karten + Theme Switch)
      const target = event.target;
      const isInteractive = target && (target.closest?.('.flip-card') || target.closest?.('#themeToggle') || target.closest?.('.theme-switch'));

      if (!isInteractive) return;

      const now = Date.now();
      if (now - lastTouchEnd <= 300) event.preventDefault();
      lastTouchEnd = now;
    }, { passive: false });
  }
	
	// ---------- Update Slider (final, smooth & stabil) ----------
function initUpdateSlider() {
  const slider = document.getElementById('updateSlider');
  const slides = document.querySelectorAll('.update-slide');
  const dots   = document.querySelectorAll('.update-dots .dot');

  if (!slider || slides.length === 0 || dots.length === 0) return;

  let current = 0;
  let startX = 0;
  let deltaX = 0;
  let isDragging = false;

  const THRESHOLD = 60;      // Mindest-Swipe-Distanz
  const DRAG_RATIO = 0.3;   // Wie stark der Slider dem Finger folgt
  const COMMIT_OFFSET = 24; // Visueller Impuls beim Wechsel
  const COMMIT_TIME = 220;  // Dauer der Commit-Animation

  // --- Anzeige eines Slides ---
  function showSlide(index) {
    slides.forEach((slide, i) => {
      slide.classList.toggle('is-active', i === index);
      dots[i].classList.toggle('is-active', i === index);
    });
    current = index;
  }

  // --- Commit-Animation (kein Snap-Back) ---
  function commitSlide(direction) {
    slider.style.transform =
      `translateX(${direction < 0 ? -COMMIT_OFFSET : COMMIT_OFFSET}px)`;

    setTimeout(() => {
      showSlide(
        direction < 0
          ? (current + 1) % slides.length
          : (current - 1 + slides.length) % slides.length
      );
      slider.style.transform = 'translateX(0)';
    }, COMMIT_TIME);
  }

  // --- ZurÃ¼cksetzen bei zu kurzem Swipe ---
  function resetSlide() {
    slider.style.transform = 'translateX(0)';
  }

  // --- Dots ---
  dots.forEach((dot, index) => {
    dot.addEventListener('click', () => showSlide(index));
  });

  // --- Touch Events ---
  slider.addEventListener('touchstart', (e) => {
    startX = e.touches[0].clientX;
    deltaX = 0;
    isDragging = true;
    slider.classList.add('is-dragging');
  }, { passive: true });

  slider.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    deltaX = e.touches[0].clientX - startX;
    slider.style.transform =
      `translateX(${deltaX * DRAG_RATIO}px)`;
  }, { passive: true });

  slider.addEventListener('touchend', () => {
    slider.classList.remove('is-dragging');
    isDragging = false;

    if (Math.abs(deltaX) > THRESHOLD) {
      commitSlide(deltaX);
    } else {
      resetSlide();
    }

    deltaX = 0;
  }, { passive: true });
}

  // ---------- Bootstrap ----------
  document.addEventListener('DOMContentLoaded', () => {
    initFlipCards();
    initThemeSwitch();
    initParagraphSearch();
		initSearchToggle();
    initServiceWorker();
    initTopicFilter();
    initDoubleTapPrevention();
		initUpdateSlider();
  });

})();
</script>

</body>

</html>